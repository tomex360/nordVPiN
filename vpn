#!/bin/bash

if [[$EUID -ne 0 ]];
	echo "Please run as root"
	exit 1	
fi


ccode=$1
default="us"

cserver=$(ls /etc/openvpn/$1* | shuf -n 1)

defaultserver=$(ls /etc/openvpn/$default* | shuf -n 1)
	
killall 'openvpn'

if [ -z "$ccode" ]

then
	echo "no country given, using default:$default"
	echo "Connecting to: $defaultserver"
	sleep 1
	sudo openvpn --config "$defaultserver" --daemon
	touch /home/pi/.config/nordVPiN/default.conf
	echo "$defaultserver" > /home/pi/.config/nordVPiN/default.conf
	cp $defaultserver /etc/openvpn/current.conf

else
      	echo "Connecting to random $ccode server"
	echo "Connecting to: $cserver"
	sudo openvpn --config "$cserver" --daemon
	touch /home/pi/.config/nordVPiN/default.conf
	echo "$cserver" > /home/pi/.config/nordVPiN/default.conf
	cp $cserver /etc/openvpn/current.conf
fi
sleep 5
proxy

